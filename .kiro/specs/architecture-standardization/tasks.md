# Implementation Plan

- [x] 1. Setup dan Infrastructure
  - [x] 1.1 Install Spatie Laravel Data package
    - Run `composer require spatie/laravel-data`
    - Verify package is installed correctly
    - _Requirements: 3.1_
  - [x] 1.2 Create base DTO class yang extend Spatie Data (optional helper)
    - Create `app/Support/BaseDataDTO.php` sebagai optional base class
    - Add common methods jika diperlukan
    - _Requirements: 3.1, 3.2_

- [x] 2. Cleanup Redundant Folders
  - [x] 2.1 Remove empty Interfaces folders dari semua modules
    - Delete `Modules/Schemes/app/Interfaces/`
    - Delete `Modules/Enrollments/app/Interfaces/`
    - Delete `Modules/Learning/app/Interfaces/`
    - Delete `Modules/Gamification/app/Interfaces/`
    - _Requirements: 5.1, 5.2, 5.3, 5.4, 5.5, 5.6_

- [x] 3. Checkpoint - Verify cleanup
  - Ensure all tests pass, ask the user if questions arise.

- [x] 4. Create Gamification Module Contracts
  - [x] 4.1 Create Gamification Repository Interfaces
    - Create `Modules/Gamification/app/Contracts/Repositories/ChallengeRepositoryInterface.php`
    - Create `Modules/Gamification/app/Contracts/Repositories/GamificationRepositoryInterface.php`
    - _Requirements: 2.1, 2.3_
  - [x] 4.2 Create Gamification Service Interfaces
    - Create `Modules/Gamification/app/Contracts/Services/ChallengeServiceInterface.php`
    - Create `Modules/Gamification/app/Contracts/Services/GamificationServiceInterface.php`
    - Create `Modules/Gamification/app/Contracts/Services/LeaderboardServiceInterface.php`
    - _Requirements: 2.2, 2.3_
  - [x] 4.3 Create Gamification Repository implementations
    - Create `Modules/Gamification/app/Repositories/ChallengeRepository.php`
    - Update `Modules/Gamification/app/Repositories/GamificationRepository.php` to implement interface
    - _Requirements: 2.1, 2.3_
  - [x] 4.4 Update Gamification Services to implement interfaces
    - Update `ChallengeService` to implement `ChallengeServiceInterface`
    - Update `GamificationService` to implement `GamificationServiceInterface`
    - Update `LeaderboardService` to implement `LeaderboardServiceInterface`
    - _Requirements: 2.2, 2.3_
  - [x] 4.5 Register Gamification bindings in ServiceProvider
    - Update `GamificationServiceProvider` to bind interfaces to implementations
    - _Requirements: 2.8_
  - [ ]* 4.6 Write property test for Gamification interface bindings
    - **Property 6: ServiceProvider Binding Completeness**
    - **Validates: Requirements 2.8, 6.5**

- [x] 5. Create Learning Module Contracts
  - [x] 5.1 Create Learning Repository Interfaces
    - Create `Modules/Learning/app/Contracts/Repositories/AssignmentRepositoryInterface.php`
    - Create `Modules/Learning/app/Contracts/Repositories/SubmissionRepositoryInterface.php`
    - Create `Modules/Learning/app/Contracts/Repositories/LearningRepositoryInterface.php`
    - _Requirements: 2.1, 2.4_
  - [x] 5.2 Create Learning Service Interfaces
    - Create `Modules/Learning/app/Contracts/Services/AssignmentServiceInterface.php`
    - Create `Modules/Learning/app/Contracts/Services/SubmissionServiceInterface.php`
    - Create `Modules/Learning/app/Contracts/Services/LearningPageServiceInterface.php`
    - _Requirements: 2.2, 2.4_
  - [x] 5.3 Update Learning Repositories to implement interfaces
    - Update `AssignmentRepository` to implement interface
    - Update `SubmissionRepository` to implement interface
    - Update `LearningRepository` to implement interface
    - _Requirements: 2.1, 2.4_
  - [x] 5.4 Update Learning Services to implement interfaces
    - Update `AssignmentService` to implement interface
    - Update `SubmissionService` to implement interface
    - Update `LearningPageService` to implement interface
    - _Requirements: 2.2, 2.4_
  - [x] 5.5 Register Learning bindings in ServiceProvider
    - Update `LearningServiceProvider` to bind interfaces to implementations
    - _Requirements: 2.8_

- [x] 6. Create Grading Module Contracts
  - [x] 6.1 Create Grading Repository Interface
    - Create `Modules/Grading/app/Contracts/Repositories/GradingRepositoryInterface.php`
    - _Requirements: 2.1, 2.5_
  - [x] 6.2 Create Grading Service Interface
    - Create `Modules/Grading/app/Contracts/Services/GradingServiceInterface.php`
    - _Requirements: 2.2, 2.5_
  - [x] 6.3 Update Grading Repository and Service to implement interfaces
    - Update `GradingRepository` to implement interface
    - Update `GradingService` to implement interface
    - _Requirements: 2.1, 2.2, 2.5_
  - [x] 6.4 Register Grading bindings in ServiceProvider
    - Update `GradingServiceProvider` to bind interfaces to implementations
    - _Requirements: 2.8_

- [x] 7. Create Forums Module Service Interfaces
  - [x] 7.1 Create Forums Service Interfaces
    - Create `Modules/Forums/app/Contracts/Services/ForumServiceInterface.php`
    - Create `Modules/Forums/app/Contracts/Services/ModerationServiceInterface.php`
    - _Requirements: 2.2, 2.6_
  - [x] 7.2 Update Forums Services to implement interfaces
    - Update `ForumService` to implement interface
    - Update `ModerationService` to implement interface
    - _Requirements: 2.2, 2.6_
  - [x] 7.3 Register Forums bindings in ServiceProvider
    - Update `ForumsServiceProvider` to bind interfaces to implementations
    - _Requirements: 2.8_

- [x] 8. Create Enrollments Module Service Interface
  - [x] 8.1 Create Enrollments Service Interface
    - Create `Modules/Enrollments/app/Contracts/Services/EnrollmentServiceInterface.php`
    - _Requirements: 2.2, 2.7_
  - [x] 8.2 Update Enrollments Service to implement interface
    - Update `EnrollmentService` to implement interface
    - _Requirements: 2.2, 2.7_
  - [x] 8.3 Register Enrollments bindings in ServiceProvider
    - Update `EnrollmentsServiceProvider` to bind interfaces to implementations
    - _Requirements: 2.8_

- [x] 9. Create Content Module Service Interfaces
  - [x] 9.1 Create Content Service Interfaces
    - Create `Modules/Content/app/Contracts/Services/AnnouncementServiceInterface.php`
    - Create `Modules/Content/app/Contracts/Services/NewsServiceInterface.php`
    - Create `Modules/Content/app/Contracts/Services/ContentStatisticsServiceInterface.php`
    - _Requirements: 2.2, 6.3_
  - [x] 9.2 Update Content Services to implement interfaces
    - Update `AnnouncementService` to implement interface
    - Update `NewsService` to implement interface
    - Update `ContentStatisticsService` to implement interface
    - _Requirements: 2.2, 6.3_
  - [x] 9.3 Register Content bindings in ServiceProvider
    - Update `ContentServiceProvider` to bind interfaces to implementations
    - _Requirements: 2.8_

- [x] 10. Checkpoint - Verify all contracts created
  - Ensure all tests pass, ask the user if questions arise.

- [x] 11. Migrate DTOs to Spatie Laravel Data - Gamification
  - [x] 11.1 Migrate CreateChallengeDTO to Spatie Data
    - Update `Modules/Gamification/app/DTOs/CreateChallengeDTO.php` to extend `Spatie\LaravelData\Data`
    - Add validation attributes
    - _Requirements: 3.1, 3.2_
  - [x] 11.2 Create UpdateChallengeDTO with Spatie Data
    - Create `Modules/Gamification/app/DTOs/UpdateChallengeDTO.php`
    - Add validation attributes with optional fields
    - _Requirements: 3.1, 3.2, 3.6_
  - [x] 11.3 Migrate CreateBadgeDTO to Spatie Data
    - Update `Modules/Gamification/app/DTOs/CreateBadgeDTO.php` to extend `Spatie\LaravelData\Data`
    - _Requirements: 3.1, 3.2_
  - [x] 11.4 Create UpdateBadgeDTO with Spatie Data
    - Create `Modules/Gamification/app/DTOs/UpdateBadgeDTO.php`
    - _Requirements: 3.1, 3.2, 3.6_
  - [ ]* 11.5 Write property test for Gamification DTOs
    - **Property 3: DTO Spatie Data Inheritance**
    - **Validates: Requirements 3.1, 3.2**

- [x] 12. Migrate DTOs to Spatie Laravel Data - Learning
  - [x] 12.1 Migrate CreateAssignmentDTO to Spatie Data
    - Update `Modules/Learning/app/DTOs/CreateAssignmentDTO.php` to extend `Spatie\LaravelData\Data`
    - _Requirements: 3.1, 3.2_
  - [x] 12.2 Create UpdateAssignmentDTO with Spatie Data
    - Create `Modules/Learning/app/DTOs/UpdateAssignmentDTO.php`
    - _Requirements: 3.1, 3.2, 3.7_
  - [x] 12.3 Migrate CreateSubmissionDTO to Spatie Data
    - Update `Modules/Learning/app/DTOs/CreateSubmissionDTO.php` to extend `Spatie\LaravelData\Data`
    - _Requirements: 3.1, 3.2_
  - [x] 12.4 Create UpdateSubmissionDTO with Spatie Data
    - Create `Modules/Learning/app/DTOs/UpdateSubmissionDTO.php`
    - _Requirements: 3.1, 3.2, 3.7_

- [x] 13. Migrate DTOs to Spatie Laravel Data - Enrollments
  - [x] 13.1 Migrate CreateEnrollmentDTO to Spatie Data
    - Update `Modules/Enrollments/app/DTOs/CreateEnrollmentDTO.php` to extend `Spatie\LaravelData\Data`
    - _Requirements: 3.1, 3.2_
  - [x] 13.2 Create UpdateEnrollmentDTO with Spatie Data
    - Create `Modules/Enrollments/app/DTOs/UpdateEnrollmentDTO.php`
    - _Requirements: 3.1, 3.2, 3.5_

- [x] 14. Create DTOs for Grading Module
  - [x] 14.1 Create CreateGradeDTO with Spatie Data
    - Create `Modules/Grading/app/DTOs/CreateGradeDTO.php`
    - _Requirements: 3.1, 3.2, 3.8_
  - [x] 14.2 Create UpdateGradeDTO with Spatie Data
    - Create `Modules/Grading/app/DTOs/UpdateGradeDTO.php`
    - _Requirements: 3.1, 3.2, 3.8_

- [x] 15. Migrate DTOs to Spatie Laravel Data - Other Modules
  - [x] 15.1 Migrate Auth DTOs to Spatie Data
    - Update `LoginDTO`, `RegisterDTO`, `ChangePasswordDTO`, `UpdateProfileDTO`
    - _Requirements: 3.1, 3.2, 3.9_
  - [x] 15.2 Migrate Schemes DTOs to Spatie Data
    - Update `CreateCourseDTO`, `UpdateCourseDTO`, `CreateUnitDTO`, `UpdateUnitDTO`, `CreateLessonDTO`, `UpdateLessonDTO`
    - _Requirements: 3.1, 3.2, 3.9_
  - [x] 15.3 Migrate Content DTOs to Spatie Data
    - Update `CreateAnnouncementDTO`, `UpdateAnnouncementDTO`, `CreateNewsDTO`, `UpdateNewsDTO`
    - _Requirements: 3.1, 3.2, 3.9_
  - [x] 15.4 Migrate Forums DTOs to Spatie Data
    - Update `CreateThreadDTO`, `UpdateThreadDTO`, `CreateReplyDTO`, `UpdateReplyDTO`
    - _Requirements: 3.1, 3.2, 3.9_

- [x] 16. Checkpoint - Verify all DTOs migrated
  - Ensure all tests pass, ask the user if questions arise.

- [x] 17. Standardize ApiResponse - Gamification Module
  - [x] 17.1 Update ChallengeController to use ApiResponse trait
    - Replace `ApiResponse::success()` with trait methods
    - Add `use ApiResponse` trait
    - _Requirements: 1.1, 1.2, 1.5_
  - [x] 17.2 Update GamificationController to use ApiResponse trait
    - Replace `ApiResponse::success()` with trait methods
    - _Requirements: 1.1, 1.2, 1.5_
  - [x] 17.3 Update LeaderboardController to use ApiResponse trait
    - Replace `ApiResponse::success()` with trait methods
    - _Requirements: 1.1, 1.2, 1.5_
  - [ ]* 17.4 Write property test for ApiResponse consistency
    - **Property 1: ApiResponse Trait Consistency**
    - **Validates: Requirements 1.1, 1.2, 1.3, 1.4, 1.5**

- [x] 18. Standardize ApiResponse - Forums Module
  - [x] 18.1 Update ThreadController to use ApiResponse trait
    - Replace `ApiResponse::successStatic()` with trait methods
    - _Requirements: 1.1, 1.2_
  - [x] 18.2 Update ReplyController to use ApiResponse trait
    - Replace `ApiResponse::successStatic()` with trait methods
    - _Requirements: 1.1, 1.2_
  - [x] 18.3 Update ReactionController to use ApiResponse trait
    - Replace `ApiResponse::successStatic()` with trait methods
    - _Requirements: 1.1, 1.2_
  - [x] 18.4 Update ForumStatisticsController to use ApiResponse trait
    - Replace `ApiResponse::successStatic()` with trait methods
    - _Requirements: 1.1, 1.2_

- [x] 19. Standardize ApiResponse - Content Module
  - [x] 19.1 Update AnnouncementController to use ApiResponse trait
    - Replace `response()->json()` with trait methods
    - Add `use ApiResponse` trait
    - _Requirements: 1.1, 1.2, 1.4_
  - [x] 19.2 Update ContentApprovalController to use ApiResponse trait
    - Replace `ApiResponse::success()` with trait methods
    - _Requirements: 1.1, 1.2_
  - [ ] 19.3 Update other Content controllers if needed
    - Check and update NewsController, ContentController, etc.
    - _Requirements: 1.1, 1.2_

- [ ] 20. Checkpoint - Verify ApiResponse standardization
  - Ensure all tests pass, ask the user if questions arise.

- [x] 21. Create Policies - Gamification Module
  - [x] 21.1 Create ChallengePolicy
    - Create `Modules/Gamification/app/Policies/ChallengePolicy.php`
    - Define viewAny, view, create, update, delete, claim methods
    - _Requirements: 4.2, 4.4_
  - [x] 21.2 Create BadgePolicy
    - Create `Modules/Gamification/app/Policies/BadgePolicy.php`
    - Define viewAny, view, create, update, delete methods
    - _Requirements: 4.2, 4.4_
  - [x] 21.3 Register Gamification Policies in AuthServiceProvider
    - Add policy mappings for Challenge and Badge models
    - _Requirements: 4.4_
  - [ ]* 21.4 Write property test for Policy authorization
    - **Property 4: Policy Authorization Consistency**
    - **Validates: Requirements 4.1, 4.8**

- [x] 22. Create Policies - Learning Module
  - [x] 22.1 Create AssignmentPolicy
    - Create `Modules/Learning/app/Policies/AssignmentPolicy.php`
    - _Requirements: 4.2, 4.5_
  - [x] 22.2 Create SubmissionPolicy
    - Create `Modules/Learning/app/Policies/SubmissionPolicy.php`
    - _Requirements: 4.2, 4.5_
  - [x] 22.3 Register Learning Policies
    - Add policy mappings in AuthServiceProvider
    - _Requirements: 4.5_

- [x] 23. Create Policies - Grading Module
  - [x] 23.1 Create GradePolicy
    - Create `Modules/Grading/app/Policies/GradePolicy.php`
    - _Requirements: 4.2, 4.6_
  - [x] 23.2 Register Grading Policies
    - Add policy mappings in AuthServiceProvider
    - _Requirements: 4.6_

- [x] 24. Create Policies - Enrollments Module
  - [x] 24.1 Create EnrollmentPolicy
    - Create `Modules/Enrollments/app/Policies/EnrollmentPolicy.php`
    - _Requirements: 4.2, 4.3_
  - [x] 24.2 Register Enrollments Policies
    - Add policy mappings in AuthServiceProvider
    - _Requirements: 4.3_

- [x] 25. Create Policies - Schemes Module
  - [x] 25.1 Create CoursePolicy
    - Create `Modules/Schemes/app/Policies/CoursePolicy.php`
    - _Requirements: 4.2, 4.7_
  - [x] 25.2 Create UnitPolicy
    - Create `Modules/Schemes/app/Policies/UnitPolicy.php`
    - _Requirements: 4.2, 4.7_
  - [x] 25.3 Create LessonPolicy
    - Create `Modules/Schemes/app/Policies/LessonPolicy.php`
    - _Requirements: 4.2, 4.7_
  - [x] 25.4 Register Schemes Policies
    - Add policy mappings in AuthServiceProvider
    - _Requirements: 4.7_

- [ ] 26. Refactor Controllers to Use Policies
  - [ ] 26.1 Refactor EnrollmentsController authorization
    - Replace manual `hasRole()` checks with `$this->authorize()` calls
    - _Requirements: 4.1, 4.8_
  - [ ] 26.2 Refactor Gamification controllers authorization
    - Replace manual role checks with Policy authorization
    - _Requirements: 4.1, 4.8_
  - [ ] 26.3 Refactor Schemes controllers authorization
    - Replace `Gate::forUser()->allows()` with `$this->authorize()`
    - _Requirements: 4.1, 4.8_

- [ ] 27. Checkpoint - Verify all policies created and working
  - Ensure all tests pass, ask the user if questions arise.

- [ ] 28. Update Architecture Documentation
  - [x] 28.1 Update docs/ARCHITECTURE.md
    - Document Spatie Laravel Data DTO pattern
    - Document ApiResponse trait usage
    - Document Policy authorization pattern
    - Document interface binding pattern
    - _Requirements: 7.1, 7.2, 7.3, 7.4_

- [x] 29. Final Checkpoint - Make sure all tests are passing
  - Ensure all tests pass, ask the user if questions arise.
